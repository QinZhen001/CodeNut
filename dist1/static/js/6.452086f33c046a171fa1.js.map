{"version":3,"sources":["webpack:///static/js/6.452086f33c046a171fa1.js","webpack:///./src/components/manager/manager-login.vue?5fa6","webpack:///./src/components/manager/manager-login.vue?bf11","webpack:///./src/components/manager/manager-login.vue","webpack:///src/components/manager/manager-login.vue","webpack:///./src/components/manager/manager-login.vue?8591"],"names":["webpackJsonp","XET2","module","exports","__webpack_require__","push","i","version","sources","names","mappings","file","sourcesContent","sourceRoot","Zdwp","content","locals","imfC","__webpack_exports__","injectStyle","ssrContext","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_manager_login_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4be0d82a_hasScoped_true_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_lib_selector_type_template_index_0_manager_login_vue__","normalizeComponent","__vue_styles__","Component","mgYX","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default","__WEBPACK_IMPORTED_MODULE_2_axios__","__WEBPACK_IMPORTED_MODULE_2_axios___default","__WEBPACK_IMPORTED_MODULE_3_common_js_cache__","__WEBPACK_IMPORTED_MODULE_4_common_js_data__","__WEBPACK_IMPORTED_MODULE_5_vuex__","__WEBPACK_IMPORTED_MODULE_6_common_js_user__","data","mangerLoginForm","username","password","rules","required","message","trigger","min","created","this","methods","submitForm","formName","_this","$refs","validate","valid","console","log","_loginManager","_this2","url","a","post","then","response","msg","FindUserInfo","result","id","user","role","token","_changeAxiosInterceptor","$notify","title","type","$router","error","_this3","interceptors","request","use","config","headers","auth","err","reject","_this4","get","saveOneUser","computed","z+FT","render","_vm","_h","$createElement","_c","_self","staticClass","_v","ref","attrs","model","label-width","prop","placeholder","callback","$$v","expression","nativeOn","keyup","$event","_k","keyCode","on","click","staticRenderFns","esExports"],"mappings":"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","file":"static/js/6.452086f33c046a171fa1.js","sourcesContent":["webpackJsonp([6],{\n\n/***/ \"XET2\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"FZ+f\")(true);\n// imports\n\n\n// module\nexports.push([module.i, \".manager-login[data-v-4be0d82a]{position:fixed;width:100%;height:100%;z-index:300;background-color:#324157}.manager-login .ms-title[data-v-4be0d82a]{position:absolute;top:50%;width:100%;margin-top:-230px;text-align:center;font-size:30px;color:#fff}.manager-login .ms-login[data-v-4be0d82a]{position:absolute;left:50%;top:50%;width:300px;height:160px;margin:-150px 0 0 -190px;padding:40px;border-radius:5px;background:#fff}.manager-login .ms-login .el-form-item[data-v-4be0d82a]{margin-bottom:20px}.manager-login .ms-login .login-btn[data-v-4be0d82a]{text-align:center;margin-top:5px}.manager-login .ms-login .login-btn button[data-v-4be0d82a]{width:100%;height:36px}\", \"\", {\"version\":3,\"sources\":[\"E:/前端/bootstrap学习/codeproject/src/components/manager/manager-login.vue\"],\"names\":[],\"mappings\":\"AACA,gCACE,eAAgB,AAChB,WAAY,AACZ,YAAa,AACb,YAAa,AACb,wBAA0B,CAC3B,AACD,0CACE,kBAAmB,AACnB,QAAS,AACT,WAAY,AACZ,kBAAmB,AACnB,kBAAmB,AACnB,eAAgB,AAChB,UAAY,CACb,AACD,0CACE,kBAAmB,AACnB,SAAU,AACV,QAAS,AACT,YAAa,AACb,aAAc,AACd,yBAA0B,AAC1B,aAAc,AACd,kBAAmB,AACnB,eAAiB,CAClB,AACD,wDACE,kBAAoB,CACrB,AACD,qDACE,kBAAmB,AACnB,cAAgB,CACjB,AACD,4DACE,WAAY,AACZ,WAAa,CACd\",\"file\":\"manager-login.vue\",\"sourcesContent\":[\"\\n.manager-login[data-v-4be0d82a] {\\n  position: fixed;\\n  width: 100%;\\n  height: 100%;\\n  z-index: 300;\\n  background-color: #324157;\\n}\\n.manager-login .ms-title[data-v-4be0d82a] {\\n  position: absolute;\\n  top: 50%;\\n  width: 100%;\\n  margin-top: -230px;\\n  text-align: center;\\n  font-size: 30px;\\n  color: #fff;\\n}\\n.manager-login .ms-login[data-v-4be0d82a] {\\n  position: absolute;\\n  left: 50%;\\n  top: 50%;\\n  width: 300px;\\n  height: 160px;\\n  margin: -150px 0 0 -190px;\\n  padding: 40px;\\n  border-radius: 5px;\\n  background: #fff;\\n}\\n.manager-login .ms-login .el-form-item[data-v-4be0d82a] {\\n  margin-bottom: 20px;\\n}\\n.manager-login .ms-login .login-btn[data-v-4be0d82a] {\\n  text-align: center;\\n  margin-top: 5px;\\n}\\n.manager-login .ms-login .login-btn button[data-v-4be0d82a] {\\n  width: 100%;\\n  height: 36px;\\n}\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"Zdwp\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"XET2\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"rjj0\")(\"33a9ac82\", content, true);\n\n/***/ }),\n\n/***/ \"imfC\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_manager_login_vue__ = __webpack_require__(\"mgYX\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4be0d82a_hasScoped_true_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_lib_selector_type_template_index_0_manager_login_vue__ = __webpack_require__(\"z+FT\");\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"Zdwp\")\n}\nvar normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4be0d82a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_manager_login_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4be0d82a_hasScoped_true_transformToRequire_video_src_source_src_img_src_image_xlink_href_node_modules_vue_loader_lib_selector_type_template_index_0_manager_login_vue__[\"a\" /* default */],\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"mgYX\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__ = __webpack_require__(\"//Fk\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__ = __webpack_require__(\"Dd8w\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_axios__ = __webpack_require__(\"mtWM\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_axios___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_axios__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_common_js_cache__ = __webpack_require__(\"Kf/3\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_common_js_data__ = __webpack_require__(\"DW9A\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_vuex__ = __webpack_require__(\"NYxO\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_common_js_user__ = __webpack_require__(\"jCJf\");\n\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// import { getToken } from 'common/js/cache'\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  data: function data() {\n    return {\n      mangerLoginForm: {\n        username: '',\n        password: ''\n      },\n      rules: {\n        username: [{ required: true, message: '用户名不能为空', trigger: 'blur' }, { min: 5, message: '用户名过短', trigger: 'blur' }],\n        password: [{ required: true, message: '密码不能为空', trigger: 'blur' }, { min: 5, message: '密码过短', trigger: 'blur' }]\n      }\n    };\n  },\n  created: function created() {\n    this.mangerLoginForm.username = '';\n    this.mangerLoginForm.password = '';\n  },\n\n  methods: __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({\n    submitForm: function submitForm(formName) {\n      var _this = this;\n\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          _this._loginManager();\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    _loginManager: function _loginManager() {\n      var _this2 = this;\n\n      var url = __WEBPACK_IMPORTED_MODULE_4_common_js_data__[\"a\" /* baseUrl */] + '/tokens';\n      __WEBPACK_IMPORTED_MODULE_2_axios___default.a.post(url, {\n        'username': this.mangerLoginForm.username,\n        'password': this.mangerLoginForm.password\n      }).then(function (response) {\n        if (response.data.msg === __WEBPACK_IMPORTED_MODULE_4_common_js_data__[\"b\" /* MSG_OK */]) {\n          // 判断用户是否是管理员\n          _this2.FindUserInfo(response.data.result[0].id);\n          // 登录成功保存 token\n          if (_this2.user.role !== 'user') {\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3_common_js_cache__[\"a\" /* saveToken */])(response.data.result[0].token);\n            // 登录后 修改axios的拦截器\n            _this2._changeAxiosInterceptor();\n            // 页面跳转\n            _this2.$notify({\n              title: '成功',\n              message: '管理员登录成功',\n              type: 'success'\n            });\n            _this2.$router.push('/home/manager');\n          } else {\n            _this2.$notify({\n              title: '错误',\n              message: '此用户不是管理员',\n              type: 'error'\n            });\n          }\n        }\n      }, function (response) {\n        console.log(response);\n        _this2.$notify.error({\n          title: '错误',\n          message: '登录失败'\n        });\n        _this2.mangerLoginForm.username = '';\n        _this2.mangerLoginForm.password = '';\n      });\n    },\n    _changeAxiosInterceptor: function _changeAxiosInterceptor() {\n      var _this3 = this;\n\n      console.log(__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3_common_js_cache__[\"b\" /* getToken */])());\n      console.log(this.mangerLoginForm);\n      __WEBPACK_IMPORTED_MODULE_2_axios___default.a.interceptors.request.use(function (config) {\n        config.headers.token = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3_common_js_cache__[\"b\" /* getToken */])();\n        config.auth = {\n          username: _this3.mangerLoginForm.username,\n          password: _this3.mangerLoginForm.password\n        };\n        return config;\n      }, function (err) {\n        return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default.a.reject(err);\n      });\n    },\n    FindUserInfo: function FindUserInfo(id) {\n      var _this4 = this;\n\n      console.log(id);\n      var url = __WEBPACK_IMPORTED_MODULE_4_common_js_data__[\"a\" /* baseUrl */] + '/users/' + id;\n      __WEBPACK_IMPORTED_MODULE_2_axios___default.a.get(url).then(function (response) {\n        if (response.data.msg === __WEBPACK_IMPORTED_MODULE_4_common_js_data__[\"b\" /* MSG_OK */]) {\n          if (response.data.result[0].role !== 'user') {\n            _this4.saveOneUser(new __WEBPACK_IMPORTED_MODULE_6_common_js_user__[\"a\" /* default */](response.data.result[0]));\n          }\n        }\n      }, function (response) {});\n    }\n  }, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_5_vuex__[\"b\" /* mapActions */])(['saveOneUser'])),\n  computed: __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({}, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_5_vuex__[\"c\" /* mapGetters */])(['user']))\n});\n\n/***/ }),\n\n/***/ \"z+FT\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"manager-login\"\n  }, [_c('div', {\n    staticClass: \"ms-title\"\n  }, [_vm._v(\"CodeNut管理员后台\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"ms-login\"\n  }, [_c('el-form', {\n    ref: \"ruleForm\",\n    staticClass: \"demo-ruleForm\",\n    attrs: {\n      \"model\": _vm.mangerLoginForm,\n      \"rules\": _vm.rules,\n      \"label-width\": \"0px\"\n    }\n  }, [_c('el-form-item', {\n    attrs: {\n      \"prop\": \"username\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"placeholder\": \"请输入管理员账号\"\n    },\n    model: {\n      value: (_vm.mangerLoginForm.username),\n      callback: function($$v) {\n        _vm.mangerLoginForm.username = $$v\n      },\n      expression: \"mangerLoginForm.username\"\n    }\n  })], 1), _vm._v(\" \"), _c('el-form-item', {\n    attrs: {\n      \"prop\": \"password\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"type\": \"password\",\n      \"placeholder\": \"请输入管理员密码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.submitForm('ruleForm')\n      }\n    },\n    model: {\n      value: (_vm.mangerLoginForm.password),\n      callback: function($$v) {\n        _vm.mangerLoginForm.password = $$v\n      },\n      expression: \"mangerLoginForm.password\"\n    }\n  })], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"login-btn\"\n  }, [_c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.submitForm('ruleForm')\n      }\n    }\n  }, [_vm._v(\"登录\")])], 1)], 1)], 1)])\n}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/6.452086f33c046a171fa1.js","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".manager-login[data-v-4be0d82a]{position:fixed;width:100%;height:100%;z-index:300;background-color:#324157}.manager-login .ms-title[data-v-4be0d82a]{position:absolute;top:50%;width:100%;margin-top:-230px;text-align:center;font-size:30px;color:#fff}.manager-login .ms-login[data-v-4be0d82a]{position:absolute;left:50%;top:50%;width:300px;height:160px;margin:-150px 0 0 -190px;padding:40px;border-radius:5px;background:#fff}.manager-login .ms-login .el-form-item[data-v-4be0d82a]{margin-bottom:20px}.manager-login .ms-login .login-btn[data-v-4be0d82a]{text-align:center;margin-top:5px}.manager-login .ms-login .login-btn button[data-v-4be0d82a]{width:100%;height:36px}\", \"\", {\"version\":3,\"sources\":[\"E:/前端/bootstrap学习/codeproject/src/components/manager/manager-login.vue\"],\"names\":[],\"mappings\":\"AACA,gCACE,eAAgB,AAChB,WAAY,AACZ,YAAa,AACb,YAAa,AACb,wBAA0B,CAC3B,AACD,0CACE,kBAAmB,AACnB,QAAS,AACT,WAAY,AACZ,kBAAmB,AACnB,kBAAmB,AACnB,eAAgB,AAChB,UAAY,CACb,AACD,0CACE,kBAAmB,AACnB,SAAU,AACV,QAAS,AACT,YAAa,AACb,aAAc,AACd,yBAA0B,AAC1B,aAAc,AACd,kBAAmB,AACnB,eAAiB,CAClB,AACD,wDACE,kBAAoB,CACrB,AACD,qDACE,kBAAmB,AACnB,cAAgB,CACjB,AACD,4DACE,WAAY,AACZ,WAAa,CACd\",\"file\":\"manager-login.vue\",\"sourcesContent\":[\"\\n.manager-login[data-v-4be0d82a] {\\n  position: fixed;\\n  width: 100%;\\n  height: 100%;\\n  z-index: 300;\\n  background-color: #324157;\\n}\\n.manager-login .ms-title[data-v-4be0d82a] {\\n  position: absolute;\\n  top: 50%;\\n  width: 100%;\\n  margin-top: -230px;\\n  text-align: center;\\n  font-size: 30px;\\n  color: #fff;\\n}\\n.manager-login .ms-login[data-v-4be0d82a] {\\n  position: absolute;\\n  left: 50%;\\n  top: 50%;\\n  width: 300px;\\n  height: 160px;\\n  margin: -150px 0 0 -190px;\\n  padding: 40px;\\n  border-radius: 5px;\\n  background: #fff;\\n}\\n.manager-login .ms-login .el-form-item[data-v-4be0d82a] {\\n  margin-bottom: 20px;\\n}\\n.manager-login .ms-login .login-btn[data-v-4be0d82a] {\\n  text-align: center;\\n  margin-top: 5px;\\n}\\n.manager-login .ms-login .login-btn button[data-v-4be0d82a] {\\n  width: 100%;\\n  height: 36px;\\n}\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-4be0d82a\",\"scoped\":true,\"hasInlineConfig\":false}!./~/stylus-loader?{\"sourceMap\":true}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/manager/manager-login.vue\n// module id = XET2\n// module chunks = 6","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4be0d82a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/stylus-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./manager-login.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"33a9ac82\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/extract-text-webpack-plugin/loader.js?{\"omit\":1,\"remove\":true}!./~/vue-style-loader!./~/css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-4be0d82a\",\"scoped\":true,\"hasInlineConfig\":false}!./~/stylus-loader?{\"sourceMap\":true}!./~/vue-loader/lib/selector.js?type=styles&index=0!./src/components/manager/manager-login.vue\n// module id = Zdwp\n// module chunks = 6","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4be0d82a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./manager-login.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./manager-login.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4be0d82a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./manager-login.vue\"\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4be0d82a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/manager/manager-login.vue\n// module id = imfC\n// module chunks = 6","<template>\n  <div class=\"manager-login\">\n    <div class=\"ms-title\">CodeNut管理员后台</div>\n    <div class=\"ms-login\">\n      <el-form :model=\"mangerLoginForm\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"0px\" class=\"demo-ruleForm\">\n        <el-form-item prop=\"username\">\n          <el-input v-model=\"mangerLoginForm.username\" placeholder=\"请输入管理员账号\"></el-input>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input type=\"password\" placeholder=\"请输入管理员密码\" v-model=\"mangerLoginForm.password\"\n                    @keyup.enter.native=\"submitForm('ruleForm')\"></el-input>\n        </el-form-item>\n        <div class=\"login-btn\">\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">登录</el-button>\n        </div>\n        <!--<p style=\"font-size:12px;line-height:30px;color:#999;\">Tips : 用户名和密码随便填。</p>-->\n      </el-form>\n    </div>\n\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  // import { getToken } from 'common/js/cache'\n  import axios from 'axios'\n  import { saveToken, getToken } from 'common/js/cache'\n  import { baseUrl, MSG_OK } from 'common/js/data'\n  import { mapGetters, mapActions } from 'vuex'\n  import User from 'common/js/user'\n\n  export default {\n    data: function () {\n      return {\n        mangerLoginForm: {\n          username: '',\n          password: ''\n        },\n        rules: {\n          username: [\n            {required: true, message: '用户名不能为空', trigger: 'blur'},\n            {min: 5, message: '用户名过短', trigger: 'blur'}\n          ],\n          password: [\n            {required: true, message: '密码不能为空', trigger: 'blur'},\n            {min: 5, message: '密码过短', trigger: 'blur'}\n          ]\n        }\n      }\n    },\n    created() {\n      this.mangerLoginForm.username = ''\n      this.mangerLoginForm.password = ''\n    },\n    methods: {\n      submitForm(formName) {\n        this.$refs[formName].validate((valid) => {\n          if (valid) {\n            this._loginManager()\n          } else {\n            console.log('error submit!!')\n            return false\n          }\n        })\n      },\n      _loginManager() {\n        let url = `${baseUrl}/tokens`\n        axios.post(url, {\n          'username': this.mangerLoginForm.username,\n          'password': this.mangerLoginForm.password\n        }).then(response => {\n          if (response.data.msg === MSG_OK) {\n            // 判断用户是否是管理员\n            this.FindUserInfo(response.data.result[0].id)\n            // 登录成功保存 token\n            if (this.user.role !== 'user') {\n              saveToken(response.data.result[0].token)\n              // 登录后 修改axios的拦截器\n              this._changeAxiosInterceptor()\n              // 页面跳转\n              this.$notify({\n                title: '成功',\n                message: '管理员登录成功',\n                type: 'success'\n              })\n              this.$router.push('/home/manager')\n            } else {\n              this.$notify({\n                title: '错误',\n                message: '此用户不是管理员',\n                type: 'error'\n              })\n            }\n          }\n        }, response => {\n          console.log(response)\n          this.$notify.error({\n            title: '错误',\n            message: '登录失败'\n          })\n          this.mangerLoginForm.username = ''\n          this.mangerLoginForm.password = ''\n        })\n      },\n      _changeAxiosInterceptor() {\n        console.log(getToken())\n        console.log(this.mangerLoginForm)\n        axios.interceptors.request.use(\n          config => {\n            config.headers.token = getToken()\n            config.auth = {\n              username: this.mangerLoginForm.username,\n              password: this.mangerLoginForm.password\n            }\n            return config\n          },\n          err => {\n            return Promise.reject(err)\n          })\n      },\n      FindUserInfo(id) {\n        console.log(id)\n        let url = `${baseUrl}/users/${id}`\n        axios.get(url).then(response => {\n          if (response.data.msg === MSG_OK) {\n            if (response.data.result[0].role !== 'user') {\n              this.saveOneUser(new User(response.data.result[0]))\n            }\n          }\n        }, response => {})\n      },\n      ...mapActions([\n        'saveOneUser'\n      ])\n\n    },\n    computed: {\n      ...mapGetters([\n        'user'\n      ])\n    }\n  }\n</script>\n\n<style scoped lang=\"stylus\" rel=\"stylesheet/stylus\">\n  .manager-login\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    z-index 300\n    background-color #324157\n    .ms-title\n      position: absolute;\n      top: 50%;\n      width: 100%;\n      margin-top: -230px;\n      text-align: center;\n      font-size: 30px;\n      color: #fff;\n    .ms-login\n      position: absolute;\n      left: 50%;\n      top: 50%;\n      width: 300px;\n      height: 160px;\n      margin: -150px 0 0 -190px;\n      padding: 40px;\n      border-radius: 5px;\n      background: #fff;\n      .el-form-item\n        margin-bottom 20px\n      .login-btn\n        text-align: center;\n        margin-top 5px\n        button\n          width: 100%;\n          height: 36px;\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/manager/manager-login.vue?190c52c2","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"manager-login\"\n  }, [_c('div', {\n    staticClass: \"ms-title\"\n  }, [_vm._v(\"CodeNut管理员后台\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"ms-login\"\n  }, [_c('el-form', {\n    ref: \"ruleForm\",\n    staticClass: \"demo-ruleForm\",\n    attrs: {\n      \"model\": _vm.mangerLoginForm,\n      \"rules\": _vm.rules,\n      \"label-width\": \"0px\"\n    }\n  }, [_c('el-form-item', {\n    attrs: {\n      \"prop\": \"username\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"placeholder\": \"请输入管理员账号\"\n    },\n    model: {\n      value: (_vm.mangerLoginForm.username),\n      callback: function($$v) {\n        _vm.mangerLoginForm.username = $$v\n      },\n      expression: \"mangerLoginForm.username\"\n    }\n  })], 1), _vm._v(\" \"), _c('el-form-item', {\n    attrs: {\n      \"prop\": \"password\"\n    }\n  }, [_c('el-input', {\n    attrs: {\n      \"type\": \"password\",\n      \"placeholder\": \"请输入管理员密码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.submitForm('ruleForm')\n      }\n    },\n    model: {\n      value: (_vm.mangerLoginForm.password),\n      callback: function($$v) {\n        _vm.mangerLoginForm.password = $$v\n      },\n      expression: \"mangerLoginForm.password\"\n    }\n  })], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"login-btn\"\n  }, [_c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.submitForm('ruleForm')\n      }\n    }\n  }, [_vm._v(\"登录\")])], 1)], 1)], 1)])\n}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-4be0d82a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"}}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/manager/manager-login.vue\n// module id = z+FT\n// module chunks = 6"],"sourceRoot":""}